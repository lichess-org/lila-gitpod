# Nginx is used to proxy lila and lila-ws traffic through the same port
# so they can be run on the same subdomain to share cookies

server {
    listen       8080;
    server_name  lichess;

    location ~ /(v5|v6)$ {
        proxy_pass http://0.0.0.0:9664;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    location / {
        proxy_pass http://0.0.0.0:9663;

        include /etc/nginx/proxy_params;
    }
}
